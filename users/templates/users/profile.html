{% extends "base.html" %}

{% block title %}Profile | FinSecure{% endblock %}

{% block content %}
<style>
/* FinSecure Profile Styles */
body {
  margin: 0;
  min-height: 100vh;
  font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
  background: linear-gradient(120deg, #244b7f 26%, #214672e3 64%, #1a2940 98%);
}

/* Fixed Top Navbar */
.topbar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: #173653;
  color: #fff;
  font-weight: 700;
  font-size: 1.4rem;
  letter-spacing: .05em;
  padding: 0.98em 2.1em;
  border-bottom: 2px solid #183f6a;
  box-shadow:  0 2px 16px #113e7524;
  z-index: 1000;
  width: 100vw; height: 58px;
  display: flex; align-items: center; justify-content: space-between;
  
}

/* Add top padding to body content to account for fixed navbar */
.content-wrapper {
  padding-top: 80px;
}

.fs-container {
  max-width: 680px;
  margin: 40px auto;
  padding: 0 12px;
  
}

.fs-card {
  background: rgb(246, 242, 242);;
  box-shadow: 0 8px 38px #183f6a29, 0 2px 8px #b2e5ff11;
  border-radius: 30px;
  border: 4px solid #13416a;
  padding: 38px 32px 32px 32px;
  margin-bottom: 25px;
  box-shadow:
    0 0 0 8px #5e92d1e6,
    0 0 20px 10px #339dff33,
    0 4px 30px #193a5e72;
   
  
}

.fs-card h2 { 
  color: #234d83; 
  font-weight: 700; 
  margin-bottom: 8px; 
  font-size: 2rem;
  text-align: center;
}

.fs-card > p {
  text-align: center;
  color: #1c4e83;
  margin-bottom: 24px;
}

.fs-subcard { 
  background: #eaf6ff; 
  border-radius: 15px; 
  margin-bottom: 19px; 
  padding: 0; 
  overflow: hidden;
  border: 1px solid #b8dff7;
}

.fs-subcard-header { 
  font-weight: 700; 
  padding: 0.8em 1.4em; 
  font-size: 1.08em; 
}

.bg-fs-dark {
  background: #1b58a1; 
  color: #fff;
}

.bg-fs-primary {
  background: #1b58a1; 
  color: #fff;
}

.bg-fs-success {
  background: #1b58a1; 
  color: #fff;
}

.fs-subcard-body { 
  padding: 18px 16px; 
}

.fs-btn { 
  border-radius: 25px; 
  font-weight: 700; 
  font-size: 1.08em; 
  padding: 13px 0; 
  width: 100%; 
  margin-bottom: 12px;
  background: linear-gradient(90deg, #1b58a1 60%); 
  color: #fff; 
  border: none; 
  cursor: pointer; 
  text-align: center; 
  display: block;
  text-decoration: none;
  box-shadow: 0 2px 14px #2966a344;
  transition: background .16s;
}

.fs-btn:hover { 
  background: linear-gradient(90deg, #234d83 60%, #2380e6 100%); 
  color: #fff;
}

.fs-btn.secondary {
  background: #eaf6ff;
  color: #234d83;
  border: 2px solid #85caff44;
}

.fs-btn.secondary:hover {
  background: #cfe7fa;
  color: #0e3159;
}

.form-control, select, textarea, input[type="text"], input[type="email"], input[type="date"], input[type="number"], input[type="file"] { 
  border-radius: 10px !important;
  border: 2px solid #bbdaf3 !important;
  background: #f7faff !important;
  color: #234d83 !important;
  padding: 10px !important;
  font-size: 1em !important;
  width: 100%;
  transition: border-color 0.18s;
}

.form-control:focus, select:focus, textarea:focus, input:focus {
  border-color: #338fff !important;
  box-shadow: 0 0 0 2px #b2e5ff48 !important;
  outline: none;
}

label {
  font-weight: 600;
  color: #234d83;
  margin-bottom: 6px;
  display: block;
}

.errorlist { 
  color: #d9534f; 
  font-size: 0.9em; 
  margin: 4px 0 8px 0; 
  list-style: none; 
  padding: 0; 
}

.alert {
  border-radius: 10px;
  padding: 12px 16px;
  margin-bottom: 16px;
}

.text-muted {
  color: #4a86c7 !important;
}

.img-thumbnail {
  border: 2px solid #85caff44;
  border-radius: 12px;
  padding: 4px;
}

@media (max-width: 600px) {
  .topbar {
    padding: 0.8em 1em;
    font-size: 1.1rem;
  }
  .fs-card {
    padding: 24px 16px;
    margin: 20px 10px;
  }
}
</style>

<!-- Fixed Top Navbar -->
<div class="topbar">
  FinSecure
</div>

<!-- Content Wrapper for spacing -->
<div class="content-wrapper">
  <div class="fs-container">
    <div class="fs-card">
      <h2>ðŸ‘¤ My Profile</h2>
      <p class="text-muted">Manage your personal and financial details</p>

      <!-- Show Django messages -->
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      {% endif %}

      <!-- Profile Update Form -->
      <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- User Info -->
        <div class="fs-subcard shadow-sm mb-3">
          <div class="fs-subcard-header bg-fs-dark">User Information</div>
          <div class="fs-subcard-body">
            <div class="mb-3">
              {{ u_form.username.label_tag }} 
              {{ u_form.username }}
              {{ u_form.username.errors }}
            </div>
            <div class="mb-3">
              {{ u_form.email.label_tag }} 
              {{ u_form.email }}
              {{ u_form.email.errors }}
            </div>
          </div>
        </div>

        <!-- Profile Details -->
        <div class="fs-subcard shadow-sm mb-3">
          <div class="fs-subcard-header bg-fs-primary">Profile Details</div>
          <div class="fs-subcard-body">
            <div class="mb-3">{{ p_form.name.label_tag }} {{ p_form.name }} {{ p_form.name.errors }}</div>
            <div class="mb-3">{{ p_form.phone.label_tag }} {{ p_form.phone }} {{ p_form.phone.errors }}</div>
            <div class="mb-3">{{ p_form.address.label_tag }} {{ p_form.address }} {{ p_form.address.errors }}</div>
            <div class="mb-3">{{ p_form.dob.label_tag }} {{ p_form.dob }} {{ p_form.dob.errors }}</div>
            <div class="mb-3">{{ p_form.gender.label_tag }} {{ p_form.gender }} {{ p_form.gender.errors }}</div>
            <div class="mb-3">{{ p_form.occupation.label_tag }} {{ p_form.occupation }} {{ p_form.occupation.errors }}</div>
            <div class="mb-3">{{ p_form.income.label_tag }} {{ p_form.income }} {{ p_form.income.errors }}</div>
          </div>
        </div>

        <!-- Profile Photo -->
        <div class="fs-subcard shadow-sm mb-3">
          <div class="fs-subcard-header bg-fs-success">Profile Photo</div>
          <div class="fs-subcard-body">
            {% if request.user.profile.profile_photo %}
              <p>Current:</p>
              <img src="{{ request.user.profile.profile_photo.url }}" 
                   class="img-thumbnail mb-2" width="150" alt="Profile Photo">
            {% endif %}
            <div class="mb-3">
              {{ p_form.profile_photo.label_tag }} 
              {{ p_form.profile_photo }}
              {{ p_form.profile_photo.errors }}
            </div>
          </div>
        </div>

        <!-- Buttons -->
        <button type="submit" class="fs-btn">ðŸ’¾ Save Changes</button>
        <a href="{% url 'dashboard' %}" class="fs-btn secondary">â¬… Back to Dashboard</a>
      </form>
    </div>
  </div>
</div>
{% endblock %}